<% content_for :meta_title, t('.title', user: @entity.profile_name) %>
<% content_for :breadcrumbs do %>
    <%= link_to(t('admin.users.nav_item.text'), admin_users_path) %>
    <%= admin_user_link(@entity) %>
    <span><%= t('.heading') %></span>
<% end %>

<article class="entity-page">
  <h1><%= @entity.profile_name %></h1>

  <ul class="actions">
    <li><%= return_icon(admin_user_path(@entity.id)) %></li>
  </ul>

  <section>
    <h2><%= t('.heading') %></h2>

    <%= render partial: 'admin/users/entity/privilege_tree', locals: { privileges: Privilege.for_tree, user: @entity } %>

    <script>
        $(function() {
            $('ul.privileges input[type=checkbox]').on('click', function() {
                let url = $(this).data('url');
                let method = $(this).is(':checked') ? 'put' : 'delete';
                $.ajax(url, {
                    method: method,
                    success: function(response) {
                        console.log(response);
                    }
                }).fail(handle_ajax_failure);
            });
        });
    </script>
  </section>
</article>